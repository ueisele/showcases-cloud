= EKS Storage

== GP2 Default

.Enable volume expansion for storage class (see https://kubernetes.io/blog/2018/07/12/resizing-persistent-volumes-using-kubernetes/)
[source,bash]
----
kubectl patch storageclass gp2 --patch "$(cat storageclass.patch)"
----

.Remove default flag from gp2 storage class
[source,bash]
----
kubectl annotate storageclass gp2 storageclass.kubernetes.io/is-default-class-
----

== EBS CSI

.Add ECS CSI storage classes
[source,bash]
----
kubectl apply -f st1.yaml
kubectl apply -f gp3.yaml
----

.Set default flag for gp3 storage class
[source,bash]
----
kubectl annotate storageclass gp3 storageclass.kubernetes.io/is-default-class=true
----

Also see:

* https://github.com/kubernetes-sigs/aws-ebs-csi-driver
* https://kubernetes.io/docs/concepts/storage/storage-classes/#aws-ebs

== Next Steps

* EFS CSI Driver: https://docs.aws.amazon.com/eks/latest/userguide/efs-csi.html

== Additional Information

* https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html